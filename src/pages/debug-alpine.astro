---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Alpine.js Debug">
  <div class="container mx-auto p-8">
    <h1 class="text-2xl font-bold mb-4">Alpine.js 调试页面</h1>
    
    <!-- 简单的Alpine.js测试 -->
    <div x-data="{ message: 'Alpine.js 正常工作!', count: 0 }" class="mb-8">
      <p x-text="message" class="text-green-600 font-semibold mb-4"></p>
      <button 
        @click="count++" 
        class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
      >
        点击计数: <span x-text="count"></span>
      </button>
    </div>
    
    <!-- 测试下拉菜单 -->
    <div x-data="{ isOpen: false }" class="relative mb-8">
      <button 
        @click="isOpen = !isOpen"
        class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"
      >
        切换下拉菜单 (当前: <span x-text="isOpen ? '打开' : '关闭'"></span>)
      </button>
      
      <div 
        x-show="isOpen"
        @click.away="isOpen = false"
        class="absolute top-full left-0 mt-2 w-48 bg-white border border-gray-200 rounded shadow-lg z-50"
      >
        <div class="p-4">
          <p class="text-gray-700">这是下拉菜单内容</p>
          <button 
            @click="isOpen = false"
            class="mt-2 bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600"
          >
            关闭菜单
          </button>
        </div>
      </div>
    </div>
    
    <!-- 测试AuthStatus组件的数据结构 -->
    <div x-data="authStatusData" class="mb-8">
      <h2 class="text-xl font-semibold mb-2">AuthStatus 组件测试</h2>
      <div class="bg-gray-100 p-4 rounded">
        <p>用户状态: <span x-text="user ? '已登录' : '未登录'"></span></p>
        <p>加载状态: <span x-text="loading ? '加载中' : '已完成'"></span></p>
        <p>下拉菜单状态: <span x-text="isOpen ? '打开' : '关闭'"></span></p>
        <button 
          @click="isOpen = !isOpen"
          class="mt-2 bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600"
        >
          切换下拉菜单
        </button>
      </div>
    </div>
    
    <!-- 控制台日志测试 -->
    <div class="mb-8">
      <h2 class="text-xl font-semibold mb-2">控制台测试</h2>
      <button 
        @click="console.log('Alpine.js 点击事件正常工作')"
        class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600"
      >
        测试控制台输出
      </button>
    </div>
  </div>
</BaseLayout>

<script is:inline>
  // 检查Alpine.js是否加载
  document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM 已加载');
    console.log('Alpine 对象:', typeof Alpine !== 'undefined' ? Alpine : '未定义');
  });
  
  document.addEventListener('alpine:init', () => {
    console.log('Alpine.js 已初始化');
    
    // 注册authStatusData以便测试
    Alpine.data('authStatusData', () => ({
      user: null,
      isOpen: false,
      loading: false,
      
      init() {
        console.log('authStatusData 已初始化');
      }
    }));
  });
</script>