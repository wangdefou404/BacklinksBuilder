---
import BaseLayout from '../layouts/BaseLayout.astro';
import ToolPageLayout from '../components/tools/ToolPageLayout.astro';
import DomainInput from '../components/tools/DomainInput.astro';
import ActionButtons from '../components/tools/ActionButtons.astro';
import ProgressBar from '../components/tools/ProgressBar.astro';
import ResultsTable from '../components/tools/ResultsTable.astro';
// import FeaturesList from '../components/tools/FeaturesList.astro'; // 未使用的导入

const tableColumns = [
  { key: 'domain', label: 'Domain', sortable: true },
  { key: 'monthlyVisits', label: 'Monthly Visits', sortable: true },
  { key: 'status', label: 'Status', sortable: false }
];

const features = [
  {
    icon: 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z',
    title: 'Batch Analysis',
    description: 'Check up to 50 domains at once for efficient bulk traffic analysis',
    iconColor: 'blue'
  },
  {
    icon: 'M13 10V3L4 14h7v7l9-11h-7z',
    title: 'Real-time Results',
    description: 'Get instant traffic metrics and performance insights as soon as analysis completes',
    iconColor: 'green'
  },
  {
    icon: 'M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z',
    title: 'Data Export',
    description: 'Export your results to CSV or JSON format for further analysis and reporting',
    iconColor: 'purple'
  }
];
---

<BaseLayout title="Traffic Checker - BacklinksBuilder">
  <ToolPageLayout 
    title="Website Traffic Checker"
    description="Analyze website traffic and performance metrics instantly. Get comprehensive traffic insights to understand your competition and improve your online presence."
    features={features}
  >
    <Fragment slot="tool-content">
      <!-- Quota Display -->
      <div id="quota-display" class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
        <div class="flex items-center justify-between">
          <div>
            <h3 class="text-sm font-medium text-green-900">Traffic Check Quota</h3>
            <p id="quota-info" class="text-sm text-green-700">Loading quota information...</p>
          </div>
          <div id="quota-upgrade" class="hidden">
            <a href="/pricing" class="inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
              Upgrade Plan
            </a>
          </div>
        </div>
      </div>
      
      <DomainInput 
        id="domains"
        label="Enter Domains (one per line, max 50)"
        placeholder="Enter domains, one per line\nExample:\nexample.com\ngoogle.com\nbaidu.com"
        maxDomains={50}
      />
      
      <ActionButtons 
        checkButtonText="Analyze Traffic"
        checkButtonId="check-btn"
        clearButtonId="clear-btn"
        showExportButton={false}
      />
      
      <ProgressBar />
    </Fragment>
    
    <Fragment slot="results">
      <ResultsTable 
        title="Traffic Analysis Results"
        columns={tableColumns}
        containerId="results-section"
        tableId="results-table"
        tbodyId="results-table-body"
      />
    </Fragment>

    

  </ToolPageLayout>
</BaseLayout>

<script src="/src/scripts/quota-manager.js" is:inline></script>
<script src="/js/traffic-checker.js" is:inline></script>

<script is:inline>
  // Initialize quota display when page loads
  document.addEventListener('DOMContentLoaded', function() {
    if (typeof QuotaManager !== 'undefined') {
      const quotaManager = new QuotaManager();
      quotaManager.initPageQuota('traffic_check');
    }
  });
</script>

<style>
  .sort-asc svg {
    transform: rotate(0deg);
  }
  .sort-desc svg {
    transform: rotate(180deg);
  }
</style>