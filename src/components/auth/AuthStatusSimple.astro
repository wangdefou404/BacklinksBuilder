---
// 简化版的AuthStatus组件用于测试
---

<div x-data="{ isOpen: false, user: { email: 'test@example.com', user_metadata: { full_name: 'Test User' } } }" class="relative">
  <!-- 登录状态显示 -->
  <div class="flex items-center space-x-4">
    <!-- 用户头像按钮 -->
    <button
      @click="console.log('点击头像，当前状态:', isOpen); isOpen = !isOpen; console.log('新状态:', isOpen)"
      class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 focus:outline-none"
    >
      <img 
        src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%234F46E5'/%3E%3Ctext x='16' y='20' text-anchor='middle' fill='white' font-size='14' font-family='Arial'%3EU%3C/text%3E%3C/svg%3E" 
        alt="用户头像" 
        class="w-8 h-8 rounded-full"
      >
      <span class="text-sm font-medium text-gray-700" x-text="user.user_metadata?.full_name || 'User'"></span>
      <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </button>
  </div>

  <!-- 下拉菜单 -->
  <div
    x-show="isOpen"
    @click.away="console.log('点击外部'); isOpen = false"
    class="absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50"
    style="display: none;"
  >
    <!-- 用户信息 -->
    <div class="px-4 py-3 border-b border-gray-100">
      <div class="flex items-center space-x-3">
        <img 
          src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%234F46E5'/%3E%3Ctext x='20' y='25' text-anchor='middle' fill='white' font-size='16' font-family='Arial'%3EU%3C/text%3E%3C/svg%3E" 
          alt="用户头像" 
          class="w-10 h-10 rounded-full"
        >
        <div class="flex-1 min-w-0">
          <p class="text-sm font-medium text-gray-900 truncate" x-text="user.user_metadata?.full_name || 'User'"></p>
          <p class="text-xs text-gray-500 truncate" x-text="user.email"></p>
        </div>
      </div>
    </div>

    <!-- 菜单项 -->
    <div class="py-1">
      <a
        href="/admin/backlinks"
        class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-150"
      >
        管理面板
      </a>
      
      <a
        href="/admin/profile"
        class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-150"
      >
        个人资料
      </a>
      
      <hr class="my-1 border-gray-100">
      
      <button
        @click="console.log('退出登录'); alert('退出登录测试'); isOpen = false"
        class="flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-150"
      >
        退出登录
      </button>
    </div>
  </div>
</div>

<script is:inline>
  // 确保Alpine.js正确处理x-show
  document.addEventListener('alpine:init', () => {
    console.log('AuthStatusSimple Alpine.js 初始化');
  });
</script>